<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JakeInSport - Advanced Scouting Dashboard</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --navy-primary: #1e3a8a;
      --navy-light: #3b82f6;
      --navy-dark: #1e40af;
      --white: #ffffff;
      --gray-50: #f9fafb;
      --gray-100: #f3f4f6;
      --gray-200: #e5e7eb;
      --gray-300: #d1d5db;
      --gray-400: #9ca3af;
      --gray-500: #6b7280;
      --gray-600: #4b5563;
      --gray-700: #374151;
      --gray-800: #1f2937;
      --gray-900: #111827;
      --technical: #8b5cf6;
      --physical: #10b981;
      --psychological: #f59e0b;
      --social: #ef4444;
      --success: #059669;
      --warning: #d97706;
      --danger: #dc2626;
    }

    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
      background: linear-gradient(135deg, var(--navy-primary) 0%, var(--navy-dark) 100%); 
      min-height: 100vh; 
      padding: 20px; 
      color: var(--gray-800);
    }

    .container { 
      max-width: 1600px; 
      margin: auto; 
      background: var(--white); 
      border-radius: 20px; 
      overflow: hidden; 
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); 
    }

    header { 
      background: linear-gradient(135deg, var(--navy-primary), var(--navy-light)); 
      color: var(--white); 
      padding: 40px 30px; 
      text-align: center; 
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="white" opacity="0.1"><path d="M0,0v46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1049.63-9.11,1000,0Z"/></svg>') no-repeat center bottom;
      background-size: cover;
    }

    header h1 { 
      font-size: 3rem; 
      font-weight: 800; 
      margin-bottom: 12px; 
      letter-spacing: -0.025em;
      text-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    header p { 
      font-size: 1.3rem; 
      opacity: 0.95; 
      font-weight: 400;
      max-width: 600px;
      margin: 0 auto;
    }

    .tabs { 
      display: flex; 
      background: var(--gray-50); 
      border-bottom: 3px solid var(--navy-primary);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .tabs button { 
      flex: 1; 
      padding: 20px 24px; 
      font-size: 1.1rem; 
      font-weight: 600;
      border: none; 
      cursor: pointer; 
      background: transparent; 
      color: var(--gray-600); 
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
      position: relative;
      border-bottom: 4px solid transparent;
    }

    .tabs button:hover { 
      background: var(--white); 
      color: var(--navy-primary); 
      transform: translateY(-2px);
    }

    .tabs button.active { 
      background: var(--white); 
      color: var(--navy-primary); 
      border-bottom-color: var(--navy-primary);
      transform: translateY(-2px);
      box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .section { 
      padding: 40px 30px; 
      display: none; 
      min-height: 80vh; 
      background: var(--gray-50);
    }

    .section.active { display: block; }

    .section-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .section-header h2 {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--navy-primary);
      margin-bottom: 16px;
      letter-spacing: -0.025em;
    }

    .section-header p {
      font-size: 1.1rem;
      color: var(--gray-600);
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* Player Info Form */
    .player-form { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
      gap: 24px; 
      margin-bottom: 40px; 
      padding: 30px; 
      background: var(--white); 
      border-radius: 16px; 
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--gray-200);
    }

    .form-group { 
      display: flex; 
      flex-direction: column; 
    }

    .form-group label { 
      font-weight: 600; 
      margin-bottom: 8px; 
      color: var(--gray-700); 
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.025em;
    }

    .form-group input, .form-group select { 
      padding: 14px 16px; 
      border: 2px solid var(--gray-200); 
      border-radius: 10px; 
      font-size: 1rem; 
      transition: all 0.3s ease;
      background: var(--white);
    }

    .form-group input:focus, .form-group select:focus { 
      outline: none; 
      border-color: var(--navy-primary); 
      box-shadow: 0 0 0 4px rgba(30, 58, 138, 0.1);
      transform: translateY(-1px);
    }

    /* Four Corner Grid */
    .four-corner-grid { 
      display: grid; 
      grid-template-columns: repeat(2, 1fr); 
      gap: 30px; 
      margin-bottom: 40px; 
    }

    .corner-card { 
      background: var(--white); 
      border-radius: 16px; 
      padding: 30px; 
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--gray-200);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .corner-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      border-radius: 16px 16px 0 0;
    }

    .corner-card.technical::before { background: var(--technical); }
    .corner-card.physical::before { background: var(--physical); }
    .corner-card.psychological::before { background: var(--psychological); }
    .corner-card.social::before { background: var(--social); }

    .corner-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }

    .corner-card h3 { 
      margin-bottom: 24px; 
      font-size: 1.5rem; 
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .corner-card.technical h3 { color: var(--technical); }
    .corner-card.physical h3 { color: var(--physical); }
    .corner-card.psychological h3 { color: var(--psychological); }
    .corner-card.social h3 { color: var(--social); }

    .trait { 
      display: flex; 
      align-items: center; 
      margin-bottom: 20px;
      padding: 8px 0;
    }

    .trait label { 
      flex: 1; 
      font-weight: 500; 
      color: var(--gray-700);
      font-size: 1rem;
    }

    .trait input[type="range"] { 
      flex: 2; 
      margin: 0 20px; 
      height: 8px; 
      border-radius: 4px; 
      background: var(--gray-200); 
      outline: none;
      transition: all 0.3s ease;
    }

    .trait input[type="range"]::-webkit-slider-thumb { 
      appearance: none; 
      width: 24px; 
      height: 24px; 
      border-radius: 50%; 
      background: var(--navy-primary); 
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }

    .trait input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .trait .score { 
      width: 40px; 
      text-align: center; 
      font-weight: 700; 
      color: var(--navy-primary); 
      font-size: 1.2rem;
      background: var(--gray-100);
      padding: 8px;
      border-radius: 8px;
      min-width: 40px;
    }

    .corner-notes { 
      width: 100%; 
      height: 100px; 
      padding: 16px; 
      border: 2px solid var(--gray-200); 
      border-radius: 12px; 
      margin-top: 20px; 
      resize: vertical;
      font-family: inherit;
      transition: all 0.3s ease;
    }

    .corner-notes:focus {
      outline: none;
      border-color: var(--navy-primary);
      box-shadow: 0 0 0 4px rgba(30, 58, 138, 0.1);
    }

    .corner-score { 
      text-align: center; 
      margin-top: 20px; 
      font-size: 1.3rem; 
      font-weight: 700;
      padding: 12px;
      background: var(--gray-100);
      border-radius: 12px;
    }

    .corner-card.technical .corner-score { color: var(--technical); }
    .corner-card.physical .corner-score { color: var(--physical); }
    .corner-card.psychological .corner-score { color: var(--psychological); }
    .corner-card.social .corner-score { color: var(--social); }

    /* Charts Section */
    .charts-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 30px;
      margin-bottom: 40px;
    }

    .chart-container { 
      background: var(--white); 
      border-radius: 16px; 
      padding: 30px; 
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--gray-200);
      transition: all 0.3s ease;
    }

    .chart-container:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }

    .chart-container h3 { 
      text-align: center; 
      margin-bottom: 20px; 
      color: var(--navy-primary);
      font-size: 1.3rem;
      font-weight: 700;
    }

    .chart-container canvas {
      max-width: 100%;
      height: auto;
    }

    /* Overall Rating */
    .overall-rating { 
      text-align: center; 
      padding: 40px; 
      background: linear-gradient(135deg, var(--navy-primary), var(--navy-light)); 
      color: var(--white); 
      border-radius: 16px; 
      margin-bottom: 40px;
      position: relative;
      overflow: hidden;
    }

    .overall-rating::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="white" opacity="0.1"><circle cx="200" cy="50" r="30"/><circle cx="800" cy="30" r="20"/><circle cx="600" cy="70" r="25"/></svg>') no-repeat;
      background-size: cover;
    }

    .overall-rating h3 { 
      font-size: 2rem; 
      margin-bottom: 16px; 
      font-weight: 700;
      position: relative;
    }

    .overall-rating .score { 
      font-size: 4rem; 
      font-weight: 800; 
      text-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      position: relative;
    }

    .overall-rating .subtitle {
      font-size: 1.1rem;
      opacity: 0.9;
      margin-top: 8px;
      position: relative;
    }

    /* Consistency Analysis */
    .consistency-section {
      background: var(--white);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 40px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--gray-200);
    }

    .consistency-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .consistency-item {
      text-align: center;
      padding: 20px;
      background: var(--gray-50);
      border-radius: 12px;
      border: 2px solid var(--gray-200);
    }

    .consistency-item.excellent { border-color: var(--success); background: rgba(5, 150, 105, 0.1); }
    .consistency-item.good { border-color: var(--physical); background: rgba(16, 185, 129, 0.1); }
    .consistency-item.average { border-color: var(--warning); background: rgba(217, 119, 6, 0.1); }
    .consistency-item.poor { border-color: var(--danger); background: rgba(220, 38, 38, 0.1); }

    .consistency-item h4 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.025em;
    }

    .consistency-item .value {
      font-size: 1.5rem;
      font-weight: 700;
    }

    .consistency-item.excellent h4, .consistency-item.excellent .value { color: var(--success); }
    .consistency-item.good h4, .consistency-item.good .value { color: var(--physical); }
    .consistency-item.average h4, .consistency-item.average .value { color: var(--warning); }
    .consistency-item.poor h4, .consistency-item.poor .value { color: var(--danger); }

    /* AI Overview Section */
    .ai-overview-section {
      background: var(--white);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 40px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--gray-200);
      position: relative;
    }

    .ai-overview-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: linear-gradient(135deg, var(--navy-primary), var(--navy-light));
      border-radius: 16px 16px 0 0;
    }

    .ai-overview-section h3 {
      text-align: center;
      margin-bottom: 20px;
      color: var(--navy-primary);
      font-size: 1.5rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .ai-overview-section h3::before {
      content: 'ðŸ¤–';
      font-size: 1.2rem;
    }

    .ai-overview-content {
      background: var(--gray-50);
      border-radius: 12px;
      padding: 24px;
      line-height: 1.7;
      font-size: 1.05rem;
      color: var(--gray-700);
      border-left: 4px solid var(--navy-primary);
    }

    .ai-loading {
      text-align: center;
      padding: 40px;
      color: var(--gray-500);
      font-style: italic;
    }

    .ai-loading .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid var(--gray-300);
      border-radius: 50%;
      border-top-color: var(--navy-primary);
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
    }

    /* Export Buttons */
    .export-buttons { 
      text-align: center; 
      padding: 30px; 
      background: var(--white); 
      margin-top: 40px; 
      border-radius: 16px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .export-buttons button { 
      margin: 8px 12px; 
      padding: 14px 28px; 
      border: none; 
      border-radius: 12px; 
      font-size: 1rem; 
      font-weight: 600;
      cursor: pointer; 
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-transform: uppercase;
      letter-spacing: 0.025em;
    }

    .btn-secondary { 
      background: var(--gray-600); 
      color: var(--white); 
    }

    .btn-secondary:hover { 
      background: var(--gray-700); 
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }

    .btn-primary { 
      background: var(--navy-primary); 
      color: var(--white); 
    }

    .btn-primary:hover { 
      background: var(--navy-dark);
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(30, 58, 138, 0.3);
    }

    .btn-success { 
      background: var(--success); 
      color: var(--white); 
    }

    .btn-success:hover { 
      background: var(--physical);
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(5, 150, 105, 0.3);
    }

    .btn-warning { 
      background: var(--warning); 
      color: var(--white); 
    }

    .btn-warning:hover { 
      background: var(--psychological);
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(217, 119, 6, 0.3);
    }

    /* Game Comparison in Overall Tab */
    .game-comparison {
      background: var(--white);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--gray-200);
    }

    .comparison-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-top: 20px;
    }

    .comparison-item {
      text-align: center;
      padding: 20px;
      border-radius: 12px;
    }

    .comparison-item.game1 { background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(139, 92, 246, 0.05)); border: 2px solid var(--technical); }
    .comparison-item.game2 { background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(16, 185, 129, 0.05)); border: 2px solid var(--physical); }
    .comparison-item.game3 { background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05)); border: 2px solid var(--psychological); }
    .comparison-item.average { background: linear-gradient(135deg, rgba(30, 58, 138, 0.1), rgba(30, 58, 138, 0.05)); border: 2px solid var(--navy-primary); }

    .comparison-item h4 {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.025em;
    }

    .comparison-item.game1 h4 { color: var(--technical); }
    .comparison-item.game2 h4 { color: var(--physical); }
    .comparison-item.game3 h4 { color: var(--psychological); }
    .comparison-item.average h4 { color: var(--navy-primary); }

    .comparison-item .score {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 8px;
    }

    .comparison-item.game1 .score { color: var(--technical); }
    .comparison-item.game2 .score { color: var(--physical); }
    .comparison-item.game3 .score { color: var(--psychological); }
    .comparison-item.average .score { color: var(--navy-primary); }

    .comparison-item .details {
      font-size: 0.9rem;
      color: var(--gray-600);
      line-height: 1.4;
    }

    /* Overall Analysis Grid Adjustments */
    .overall-analysis-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 30px;
      margin-bottom: 40px;
    }

    /* Custom Icons using CSS */
    .icon-technical::before { content: "âš½"; }
    .icon-physical::before { content: "ðŸ’ª"; }
    .icon-psychological::before { content: "ðŸ§ "; }
    .icon-social::before { content: "ðŸ‘¥"; }

    /* Loading Animation */
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* PDF Export Loading Overlay */
    .pdf-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      display: none;
    }

    .pdf-loading-content {
      background: white;
      padding: 40px;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
    }

    .pdf-loading-content .spinner {
      display: inline-block;
      width: 40px;
      height: 40px;
      border: 4px solid var(--gray-300);
      border-radius: 50%;
      border-top-color: var(--navy-primary);
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    .pdf-loading-content h3 {
      color: var(--navy-primary);
      margin-bottom: 10px;
      font-size: 1.5rem;
    }

    .pdf-loading-content p {
      color: var(--gray-600);
      font-size: 1rem;
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .four-corner-grid {
        grid-template-columns: 1fr;
      }
      
      .charts-section {
        grid-template-columns: 1fr;
      }
      
      .comparison-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .overall-analysis-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .container {
        margin: 10px;
        border-radius: 16px;
      }
      
      header {
        padding: 30px 20px;
      }
      
      header h1 {
        font-size: 2.5rem;
      }
      
      .section {
        padding: 30px 20px;
      }
      
      .tabs button {
        padding: 16px 12px;
        font-size: 1rem;
      }
      
      .player-form {
        grid-template-columns: 1fr;
        gap: 16px;
        padding: 20px;
      }
      
      .comparison-grid {
        grid-template-columns: 1fr;
      }
    }

    @media print {
      .tabs, .export-buttons {
        display: none;
      }
      
      .section {
        display: block !important;
        page-break-after: always;
      }
      
      .section:last-child {
        page-break-after: avoid;
      }
    }
  </style>
</head>
<body>
  <!-- PDF Loading Overlay -->
  <div id="pdf-overlay" class="pdf-overlay">
    <div class="pdf-loading-content">
      <div class="spinner"></div>
      <h3>Generating PDF...</h3>
      <p>Please wait while we create your professional report</p>
    </div>
  </div>

  <div class="container">
    <header>
      <h1>JakeInSport</h1>
      <p>Advanced Three-Game Scouting Dashboard - FA Four Corner Model Analysis</p>
    </header>
    
    <div class="tabs">
      <button id="btn-game1" class="active">Game 1</button>
      <button id="btn-game2">Game 2</button>
      <button id="btn-game3">Game 3</button>
      <button id="btn-overall">Overall Analysis</button>
    </div>

    <!-- Game 1 Section -->
    <div id="game1" class="section active">
      <div class="section-header">
        <h2>Game 1 Analysis</h2>
        <p>Comprehensive scouting assessment for the first match using the FA Four Corner model</p>
      </div>

      <div class="player-form">
        <div class="form-group">
          <label>Player Name</label>
          <input id="game1-playerName" type="text" placeholder="Enter player name">
        </div>
        <div class="form-group">
          <label>Position</label>
          <input id="game1-position" type="text" placeholder="e.g., CM, ST, CB">
        </div>
        <div class="form-group">
          <label>Age</label>
          <input id="game1-age" type="number" placeholder="Age">
        </div>
        <div class="form-group">
          <label>Match Date</label>
          <input id="game1-matchDate" type="date">
        </div>
        <div class="form-group">
          <label>Opposition</label>
          <input id="game1-opposition" type="text" placeholder="Opponent team">
        </div>
        <div class="form-group">
          <label>Competition</label>
          <input id="game1-competition" type="text" placeholder="e.g., Premier League">
        </div>
        <div class="form-group">
          <label>Match Result</label>
          <input id="game1-result" type="text" placeholder="e.g., 2-1 Win">
        </div>
        <div class="form-group">
          <label>Minutes Played</label>
          <input id="game1-minutes" type="number" placeholder="90" max="90">
        </div>
      </div>

      <div class="four-corner-grid">
        <div class="corner-card technical">
          <h3><span class="icon-technical"></span>Technical</h3>
          <div class="trait">
            <label>Ball Control</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="technical" data-trait="control">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Passing</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="technical" data-trait="passing">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Shooting</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="technical" data-trait="shooting">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Dribbling</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="technical" data-trait="dribbling">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Defending</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="technical" data-trait="defending">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Technical observations and notes..."></textarea>
          <div class="corner-score">Technical Score: <span id="game1-technical-score">5.0</span></div>
        </div>

        <div class="corner-card physical">
          <h3><span class="icon-physical"></span>Physical</h3>
          <div class="trait">
            <label>Pace</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="physical" data-trait="pace">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Strength</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="physical" data-trait="strength">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Stamina</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="physical" data-trait="stamina">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Agility</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="physical" data-trait="agility">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Aerial Ability</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="physical" data-trait="aerial">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Physical observations and notes..."></textarea>
          <div class="corner-score">Physical Score: <span id="game1-physical-score">5.0</span></div>
        </div>

        <div class="corner-card psychological">
          <h3><span class="icon-psychological"></span>Psychological</h3>
          <div class="trait">
            <label>Concentration</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="psychological" data-trait="concentration">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Confidence</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="psychological" data-trait="confidence">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Composure</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="psychological" data-trait="composure">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Mental Strength</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="psychological" data-trait="mental">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Decision Making</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="psychological" data-trait="decisions">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Psychological observations and notes..."></textarea>
          <div class="corner-score">Psychological Score: <span id="game1-psychological-score">5.0</span></div>
        </div>

        <div class="corner-card social">
          <h3><span class="icon-social"></span>Social</h3>
          <div class="trait">
            <label>Communication</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="social" data-trait="communication">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Leadership</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="social" data-trait="leadership">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Teamwork</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="social" data-trait="teamwork">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Attitude</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="social" data-trait="attitude">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Respect</label>
            <input type="range" min="1" max="10" value="5" data-game="1" data-cat="social" data-trait="respect">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Social observations and notes..."></textarea>
          <div class="corner-score">Social Score: <span id="game1-social-score">5.0</span></div>
        </div>
      </div>

      <div class="charts-section">
        <div class="chart-container">
          <h3>Game 1 Radar Chart</h3>
          <canvas id="game1-radar" width="400" height="400"></canvas>
        </div>
        <div class="chart-container">
          <h3>Category Breakdown</h3>
          <canvas id="game1-bar" width="400" height="300"></canvas>
        </div>
      </div>

      <div class="overall-rating">
        <h3>Game 1 Overall Rating</h3>
        <div class="score" id="game1-overall">5.0</div>
        <div class="subtitle">Out of 10</div>
      </div>

      <div class="export-buttons">
        <button class="btn-secondary" onclick="loadSampleData(1)">Load Sample Data</button>
        <button class="btn-primary" onclick="exportGameExcel(1)">Export to Excel</button>
        <button class="btn-warning" onclick="exportGamePDF(1)">Export PDF</button>
        <button class="btn-success" onclick="saveGameJSON(1)">Save JSON</button>
      </div>
    </div>

    <!-- Game 2 Section -->
    <div id="game2" class="section">
      <div class="section-header">
        <h2>Game 2 Analysis</h2>
        <p>Comprehensive scouting assessment for the second match using the FA Four Corner model</p>
      </div>

      <div class="player-form">
        <div class="form-group">
          <label>Player Name</label>
          <input id="game2-playerName" type="text" placeholder="Enter player name">
        </div>
        <div class="form-group">
          <label>Position</label>
          <input id="game2-position" type="text" placeholder="e.g., CM, ST, CB">
        </div>
        <div class="form-group">
          <label>Age</label>
          <input id="game2-age" type="number" placeholder="Age">
        </div>
        <div class="form-group">
          <label>Match Date</label>
          <input id="game2-matchDate" type="date">
        </div>
        <div class="form-group">
          <label>Opposition</label>
          <input id="game2-opposition" type="text" placeholder="Opponent team">
        </div>
        <div class="form-group">
          <label>Competition</label>
          <input id="game2-competition" type="text" placeholder="e.g., Premier League">
        </div>
        <div class="form-group">
          <label>Match Result</label>
          <input id="game2-result" type="text" placeholder="e.g., 2-1 Win">
        </div>
        <div class="form-group">
          <label>Minutes Played</label>
          <input id="game2-minutes" type="number" placeholder="90" max="90">
        </div>
      </div>

      <div class="four-corner-grid">
        <div class="corner-card technical">
          <h3><span class="icon-technical"></span>Technical</h3>
          <div class="trait">
            <label>Ball Control</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="technical" data-trait="control">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Passing</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="technical" data-trait="passing">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Shooting</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="technical" data-trait="shooting">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Dribbling</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="technical" data-trait="dribbling">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Defending</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="technical" data-trait="defending">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Technical observations and notes..."></textarea>
          <div class="corner-score">Technical Score: <span id="game2-technical-score">5.0</span></div>
        </div>

        <div class="corner-card physical">
          <h3><span class="icon-physical"></span>Physical</h3>
          <div class="trait">
            <label>Pace</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="physical" data-trait="pace">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Strength</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="physical" data-trait="strength">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Stamina</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="physical" data-trait="stamina">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Agility</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="physical" data-trait="agility">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Aerial Ability</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="physical" data-trait="aerial">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Physical observations and notes..."></textarea>
          <div class="corner-score">Physical Score: <span id="game2-physical-score">5.0</span></div>
        </div>

        <div class="corner-card psychological">
          <h3><span class="icon-psychological"></span>Psychological</h3>
          <div class="trait">
            <label>Concentration</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="psychological" data-trait="concentration">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Confidence</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="psychological" data-trait="confidence">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Composure</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="psychological" data-trait="composure">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Mental Strength</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="psychological" data-trait="mental">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Decision Making</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="psychological" data-trait="decisions">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Psychological observations and notes..."></textarea>
          <div class="corner-score">Psychological Score: <span id="game2-psychological-score">5.0</span></div>
        </div>

        <div class="corner-card social">
          <h3><span class="icon-social"></span>Social</h3>
          <div class="trait">
            <label>Communication</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="social" data-trait="communication">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Leadership</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="social" data-trait="leadership">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Teamwork</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="social" data-trait="teamwork">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Attitude</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="social" data-trait="attitude">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Respect</label>
            <input type="range" min="1" max="10" value="5" data-game="2" data-cat="social" data-trait="respect">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Social observations and notes..."></textarea>
          <div class="corner-score">Social Score: <span id="game2-social-score">5.0</span></div>
        </div>
      </div>

      <div class="charts-section">
        <div class="chart-container">
          <h3>Game 2 Radar Chart</h3>
          <canvas id="game2-radar" width="400" height="400"></canvas>
        </div>
        <div class="chart-container">
          <h3>Category Breakdown</h3>
          <canvas id="game2-bar" width="400" height="300"></canvas>
        </div>
      </div>

      <div class="overall-rating">
        <h3>Game 2 Overall Rating</h3>
        <div class="score" id="game2-overall">5.0</div>
        <div class="subtitle">Out of 10</div>
      </div>

      <div class="export-buttons">
        <button class="btn-secondary" onclick="loadSampleData(2)">Load Sample Data</button>
        <button class="btn-primary" onclick="exportGameExcel(2)">Export to Excel</button>
        <button class="btn-warning" onclick="exportGamePDF(2)">Export PDF</button>
        <button class="btn-success" onclick="saveGameJSON(2)">Save JSON</button>
      </div>
    </div>

    <!-- Game 3 Section -->
    <div id="game3" class="section">
      <div class="section-header">
        <h2>Game 3 Analysis</h2>
        <p>Comprehensive scouting assessment for the third match using the FA Four Corner model</p>
      </div>

      <div class="player-form">
        <div class="form-group">
          <label>Player Name</label>
          <input id="game3-playerName" type="text" placeholder="Enter player name">
        </div>
        <div class="form-group">
          <label>Position</label>
          <input id="game3-position" type="text" placeholder="e.g., CM, ST, CB">
        </div>
        <div class="form-group">
          <label>Age</label>
          <input id="game3-age" type="number" placeholder="Age">
        </div>
        <div class="form-group">
          <label>Match Date</label>
          <input id="game3-matchDate" type="date">
        </div>
        <div class="form-group">
          <label>Opposition</label>
          <input id="game3-opposition" type="text" placeholder="Opponent team">
        </div>
        <div class="form-group">
          <label>Competition</label>
          <input id="game3-competition" type="text" placeholder="e.g., Premier League">
        </div>
        <div class="form-group">
          <label>Match Result</label>
          <input id="game3-result" type="text" placeholder="e.g., 2-1 Win">
        </div>
        <div class="form-group">
          <label>Minutes Played</label>
          <input id="game3-minutes" type="number" placeholder="90" max="90">
        </div>
      </div>

      <div class="four-corner-grid">
        <div class="corner-card technical">
          <h3><span class="icon-technical"></span>Technical</h3>
          <div class="trait">
            <label>Ball Control</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="technical" data-trait="control">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Passing</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="technical" data-trait="passing">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Shooting</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="technical" data-trait="shooting">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Dribbling</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="technical" data-trait="dribbling">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Defending</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="technical" data-trait="defending">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Technical observations and notes..."></textarea>
          <div class="corner-score">Technical Score: <span id="game3-technical-score">5.0</span></div>
        </div>

        <div class="corner-card physical">
          <h3><span class="icon-physical"></span>Physical</h3>
          <div class="trait">
            <label>Pace</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="physical" data-trait="pace">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Strength</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="physical" data-trait="strength">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Stamina</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="physical" data-trait="stamina">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Agility</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="physical" data-trait="agility">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Aerial Ability</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="physical" data-trait="aerial">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Physical observations and notes..."></textarea>
          <div class="corner-score">Physical Score: <span id="game3-physical-score">5.0</span></div>
        </div>

        <div class="corner-card psychological">
          <h3><span class="icon-psychological"></span>Psychological</h3>
          <div class="trait">
            <label>Concentration</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="psychological" data-trait="concentration">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Confidence</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="psychological" data-trait="confidence">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Composure</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="psychological" data-trait="composure">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Mental Strength</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="psychological" data-trait="mental">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Decision Making</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="psychological" data-trait="decisions">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Psychological observations and notes..."></textarea>
          <div class="corner-score">Psychological Score: <span id="game3-psychological-score">5.0</span></div>
        </div>

        <div class="corner-card social">
          <h3><span class="icon-social"></span>Social</h3>
          <div class="trait">
            <label>Communication</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="social" data-trait="communication">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Leadership</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="social" data-trait="leadership">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Teamwork</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="social" data-trait="teamwork">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Attitude</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="social" data-trait="attitude">
            <span class="score">5</span>
          </div>
          <div class="trait">
            <label>Respect</label>
            <input type="range" min="1" max="10" value="5" data-game="3" data-cat="social" data-trait="respect">
            <span class="score">5</span>
          </div>
          <textarea class="corner-notes" placeholder="Social observations and notes..."></textarea>
          <div class="corner-score">Social Score: <span id="game3-social-score">5.0</span></div>
        </div>
      </div>

      <div class="charts-section">
        <div class="chart-container">
          <h3>Game 3 Radar Chart</h3>
          <canvas id="game3-radar" width="400" height="400"></canvas>
        </div>
        <div class="chart-container">
          <h3>Category Breakdown</h3>
          <canvas id="game3-bar" width="400" height="300"></canvas>
        </div>
      </div>

      <div class="overall-rating">
        <h3>Game 3 Overall Rating</h3>
        <div class="score" id="game3-overall">5.0</div>
        <div class="subtitle">Out of 10</div>
      </div>

      <div class="export-buttons">
        <button class="btn-secondary" onclick="loadSampleData(3)">Load Sample Data</button>
        <button class="btn-primary" onclick="exportGameExcel(3)">Export to Excel</button>
        <button class="btn-warning" onclick="exportGamePDF(3)">Export PDF</button>
        <button class="btn-success" onclick="saveGameJSON(3)">Save JSON</button>
      </div>
    </div>

    <!-- Overall Analysis Section -->
    <div id="overall" class="section">
      <div class="section-header">
        <h2>Overall Analysis</h2>
        <p>Comprehensive three-game analysis with consistency tracking and performance comparison</p>
      </div>

      <div class="game-comparison">
        <h3 style="text-align: center; margin-bottom: 20px; color: var(--navy-primary); font-size: 1.5rem;">Three-Game Performance Comparison</h3>
        <div class="comparison-grid">
          <div class="comparison-item game1">
            <h4>Game 1</h4>
            <div class="score" id="overall-game1-score">5.0</div>
            <div class="details" id="overall-game1-details">No data available</div>
          </div>
          <div class="comparison-item game2">
            <h4>Game 2</h4>
            <div class="score" id="overall-game2-score">5.0</div>
            <div class="details" id="overall-game2-details">No data available</div>
          </div>
          <div class="comparison-item game3">
            <h4>Game 3</h4>
            <div class="score" id="overall-game3-score">5.0</div>
            <div class="details" id="overall-game3-details">No data available</div>
          </div>
          <div class="comparison-item average">
            <h4>Average</h4>
            <div class="score" id="overall-average-score">5.0</div>
            <div class="details" id="overall-average-details">Overall performance</div>
          </div>
        </div>
      </div>

      <div class="consistency-section">
        <h3 style="text-align: center; margin-bottom: 20px; color: var(--navy-primary); font-size: 1.5rem;">Consistency Analysis</h3>
        <div class="consistency-grid">
          <div class="consistency-item" id="technical-consistency">
            <h4>Technical</h4>
            <div class="value" id="technical-consistency-value">0.0</div>
            <div style="font-size: 0.8rem; margin-top: 4px;">Standard Deviation</div>
          </div>
          <div class="consistency-item" id="physical-consistency">
            <h4>Physical</h4>
            <div class="value" id="physical-consistency-value">0.0</div>
            <div style="font-size: 0.8rem; margin-top: 4px;">Standard Deviation</div>
          </div>
          <div class="consistency-item" id="psychological-consistency">
            <h4>Psychological</h4>
            <div class="value" id="psychological-consistency-value">0.0</div>
            <div style="font-size: 0.8rem; margin-top: 4px;">Standard Deviation</div>
          </div>
          <div class="consistency-item" id="social-consistency">
            <h4>Social</h4>
            <div class="value" id="social-consistency-value">0.0</div>
            <div style="font-size: 0.8rem; margin-top: 4px;">Standard Deviation</div>
          </div>
          <div class="consistency-item" id="overall-consistency">
            <h4>Overall Rating</h4>
            <div class="value" id="overall-consistency-value">0.0</div>
            <div style="font-size: 0.8rem; margin-top: 4px;">Consistency Score</div>
          </div>
        </div>
      </div>

      <div class="overall-analysis-grid">
        <div class="charts-section">
          <div class="chart-container">
            <h3>Three-Game Radar Comparison</h3>
            <canvas id="overall-radar" width="400" height="400"></canvas>
          </div>
          <div class="chart-container">
            <h3>Performance Progression</h3>
            <canvas id="overall-line" width="400" height="300"></canvas>
          </div>
          <div class="chart-container">
            <h3>Category Averages</h3>
            <canvas id="overall-bar" width="400" height="300"></canvas>
          </div>
          <div class="chart-container">
            <h3>Consistency Breakdown</h3>
            <canvas id="overall-consistency-chart" width="400" height="300"></canvas>
          </div>
        </div>

        <div class="ai-overview-section">
          <h3>AI Overview</h3>
          <div class="ai-overview-content" id="ai-overview-content">
            <div style="text-align: center; padding: 20px; color: var(--gray-500); font-style: italic;">
              Click "Generate AI Analysis" to get an intelligent overview of the player's performance across all three games.
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 20px;">
            <button class="btn-primary" onclick="generateAIOverview()" id="generate-ai-btn"
              style="padding: 12px 24px; border-radius: 999px; font-size: 1rem; font-weight: 600; border: none; cursor: pointer;">
              Generate AI Analysis
            </button>
          </div>
        </div>
      </div>

      <div class="overall-rating">
        <h3>Final Scout Report Rating</h3>
        <div class="score" id="final-overall">5.0</div>
        <div class="subtitle">Average Across Three Games</div>
      </div>

      <div class="export-buttons">
        <button class="btn-secondary" onclick="loadAllSampleData()">Load All Sample Data</button>
        <button class="btn-primary" onclick="exportCompleteExcel()">Export to Excel</button>
        <button class="btn-warning" onclick="exportOverallPDF()">Export PDF</button>
        <button class="btn-success" onclick="saveCompleteJSON()">Save Complete JSON</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  
  <script>
    // Global variables for charts and state
    let charts = {
      game1: { radar: null, bar: null },
      game2: { radar: null, bar: null },
      game3: { radar: null, bar: null },
      overall: { radar: null, line: null, bar: null, consistency: null }
    };

    let aiOverviewGenerated = false;

    // Tab switching functionality
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('btn-game1').addEventListener('click', () => switchTab('game1'));
      document.getElementById('btn-game2').addEventListener('click', () => switchTab('game2'));
      document.getElementById('btn-game3').addEventListener('click', () => switchTab('game3'));
      document.getElementById('btn-overall').addEventListener('click', () => switchTab('overall'));
      
      setupEventListeners();
      
      // Initialize all game scores and charts
      for (let game = 1; game <= 3; game++) {
        updateGameScores(game);
        updateGameCharts(game);
      }
      
      updateOverallAnalysis();
    });

    function switchTab(tabName) {
      // Hide all sections
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Remove active from all tabs
      document.querySelectorAll('.tabs button').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Show selected section and mark tab as active
      document.getElementById(tabName).classList.add('active');
      document.getElementById(`btn-${tabName}`).classList.add('active');

      // Update charts for the active tab
      if (tabName === 'overall') {
        updateOverallAnalysis();
      } else {
        updateGameCharts(parseInt(tabName.replace('game', '')));
      }
    }

    // Setup event listeners for all games
    function setupEventListeners() {
      for (let game = 1; game <= 3; game++) {
        const sliders = document.querySelectorAll(`input[data-game="${game}"]`);
        sliders.forEach(slider => {
          slider.addEventListener('input', function() {
            // Update the score display
            const scoreSpan = this.parentElement.querySelector('.score');
            scoreSpan.textContent = this.value;
            
            // Update category scores and overall
            updateGameScores(game);
            updateGameCharts(game);
            
            // Reset AI overview when data changes
            aiOverviewGenerated = false;
            resetAIOverview();
            
            // Update overall analysis if on overall tab
            if (document.getElementById('overall').classList.contains('active')) {
              updateOverallAnalysis();
            }
          });
        });
      }
    }

    // Reset AI Overview
    function resetAIOverview() {
      const aiContent = document.getElementById('ai-overview-content');
      const generateBtn = document.getElementById('generate-ai-btn');
      
      aiContent.innerHTML = `
        <div style="text-align: center; padding: 20px; color: var(--gray-500); font-style: italic;">
          Click "Generate AI Analysis" to get an intelligent overview of the player's performance across all three games.
        </div>
      `;
      generateBtn.textContent = 'Generate AI Analysis';
      generateBtn.disabled = false;
    }

    // Update scores for a specific game
    function updateGameScores(game) {
      const categories = ['technical', 'physical', 'psychological', 'social'];
      let totalScore = 0;
      
      categories.forEach(category => {
        const sliders = document.querySelectorAll(`input[data-game="${game}"][data-cat="${category}"]`);
        let categorySum = 0;
        
        sliders.forEach(slider => {
          categorySum += parseInt(slider.value);
        });
        
        const categoryAverage = (categorySum / sliders.length).toFixed(1);
        const scoreElement = document.getElementById(`game${game}-${category}-score`);
        if (scoreElement) {
          scoreElement.textContent = categoryAverage;
        }
        totalScore += parseFloat(categoryAverage);
      });
      
      const overallScore = (totalScore / categories.length).toFixed(1);
      const overallElement = document.getElementById(`game${game}-overall`);
      if (overallElement) {
        overallElement.textContent = overallScore;
      }
    }

    // Update charts for a specific game
    function updateGameCharts(game) {
      const categories = ['technical', 'physical', 'psychological', 'social'];
      const scores = categories.map(cat => {
        const element = document.getElementById(`game${game}-${cat}-score`);
        return element ? parseFloat(element.textContent) : 5.0;
      });

      // Update radar chart
      updateRadarChart(game, scores);
      updateBarChart(game, scores);
    }

    // Update radar chart
    function updateRadarChart(game, scores) {
      const canvas = document.getElementById(`game${game}-radar`);
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      
      const data = {
        labels: ['Technical', 'Physical', 'Psychological', 'Social'],
        datasets: [{
          label: `Game ${game} Scores`,
          data: scores,
          fill: true,
          backgroundColor: 'rgba(30, 58, 138, 0.2)',
          borderColor: 'rgba(30, 58, 138, 1)',
          pointBackgroundColor: 'rgba(30, 58, 138, 1)',
          pointBorderColor: '#fff',
          pointHoverBackgroundColor: '#fff',
          pointHoverBorderColor: 'rgba(30, 58, 138, 1)',
          pointRadius: 6,
          pointHoverRadius: 8
        }]
      };

      const config = {
        type: 'radar',
        data: data,
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: {
            r: {
              beginAtZero: true,
              max: 10,
              min: 0,
              ticks: {
                stepSize: 2,
                font: { size: 12 }
              },
              grid: {
                color: 'rgba(0, 0, 0, 0.1)'
              },
              angleLines: {
                color: 'rgba(0, 0, 0, 0.1)'
              }
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      };

      if (charts[`game${game}`].radar) {
        charts[`game${game}`].radar.destroy();
      }
      
      charts[`game${game}`].radar = new Chart(ctx, config);
    }

    // Update bar chart
    function updateBarChart(game, scores) {
      const canvas = document.getElementById(`game${game}-bar`);
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      
      const colors = ['#8b5cf6', '#10b981', '#f59e0b', '#ef4444'];
      
      const data = {
        labels: ['Technical', 'Physical', 'Psychological', 'Social'],
        datasets: [{
          data: scores,
          backgroundColor: colors,
          borderColor: colors,
          borderWidth: 2,
          borderRadius: 8
        }]
      };

      const config = {
        type: 'bar',
        data: data,
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: {
            y: {
              beginAtZero: true,
              max: 10,
              ticks: {
                stepSize: 1
              }
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      };

      if (charts[`game${game}`].bar) {
        charts[`game${game}`].bar.destroy();
      }
      
      charts[`game${game}`].bar = new Chart(ctx, config);
    }

    // Update overall analysis
    function updateOverallAnalysis() {
      const categories = ['technical', 'physical', 'psychological', 'social'];
      const gameData = [];
      
      // Collect data from all three games
      for (let game = 1; game <= 3; game++) {
        const gameScores = categories.map(cat => {
          const element = document.getElementById(`game${game}-${cat}-score`);
          return element ? parseFloat(element.textContent) : 5.0;
        });
        const overallElement = document.getElementById(`game${game}-overall`);
        const overall = overallElement ? parseFloat(overallElement.textContent) : 5.0;
        gameData.push({ scores: gameScores, overall });
      }

      // Update comparison cards
      for (let game = 1; game <= 3; game++) {
        const scoreElement = document.getElementById(`overall-game${game}-score`);
        const detailsElement = document.getElementById(`overall-game${game}-details`);
        
        if (scoreElement) {
          scoreElement.textContent = gameData[game-1].overall.toFixed(1);
        }
        
        if (detailsElement) {
          // Get match details
          const opposition = document.getElementById(`game${game}-opposition`)?.value || 'Unknown';
          const result = document.getElementById(`game${game}-result`)?.value || 'N/A';
          detailsElement.textContent = `vs ${opposition} (${result})`;
        }
      }

      // Calculate averages
      const avgScores = categories.map((_, catIndex) => {
        const sum = gameData.reduce((acc, game) => acc + game.scores[catIndex], 0);
        return sum / gameData.length;
      });
      
      const avgOverall = gameData.reduce((acc, game) => acc + game.overall, 0) / gameData.length;
      
      const avgScoreElement = document.getElementById('overall-average-score');
      const finalOverallElement = document.getElementById('final-overall');
      
      if (avgScoreElement) avgScoreElement.textContent = avgOverall.toFixed(1);
      if (finalOverallElement) finalOverallElement.textContent = avgOverall.toFixed(1);

      // Calculate consistency (standard deviation)
      const consistencyData = categories.map((cat, catIndex) => {
        const scores = gameData.map(game => game.scores[catIndex]);
        const mean = avgScores[catIndex];
        const variance = scores.reduce((acc, score) => acc + Math.pow(score - mean, 2), 0) / scores.length;
        return Math.sqrt(variance);
      });

      const overallConsistency = (() => {
        const overallScores = gameData.map(game => game.overall);
        const mean = avgOverall;
        const variance = overallScores.reduce((acc, score) => acc + Math.pow(score - mean, 2), 0) / overallScores.length;
        return Math.sqrt(variance);
      })();

      // Update consistency display
      categories.forEach((cat, index) => {
        const consistency = consistencyData[index];
        const element = document.getElementById(`${cat}-consistency`);
        const valueElement = document.getElementById(`${cat}-consistency-value`);
        
        if (valueElement) {
          valueElement.textContent = consistency.toFixed(2);
        }
        
        if (element) {
          // Color code consistency
          element.className = 'consistency-item';
          if (consistency <= 0.5) element.classList.add('excellent');
          else if (consistency <= 1.0) element.classList.add('good');
          else if (consistency <= 1.5) element.classList.add('average');
          else element.classList.add('poor');
        }
      });

      // Overall consistency
      const overallConsistencyElement = document.getElementById('overall-consistency');
      const overallConsistencyValue = document.getElementById('overall-consistency-value');
      
      if (overallConsistencyValue) {
        overallConsistencyValue.textContent = overallConsistency.toFixed(2);
      }
      
      if (overallConsistencyElement) {
        overallConsistencyElement.className = 'consistency-item';
        if (overallConsistency <= 0.5) overallConsistencyElement.classList.add('excellent');
        else if (overallConsistency <= 1.0) overallConsistencyElement.classList.add('good');
        else if (overallConsistency <= 1.5) overallConsistencyElement.classList.add('average');
        else overallConsistencyElement.classList.add('poor');
      }

      // Update overall charts
      updateOverallRadarChart(gameData, avgScores);
      updateOverallLineChart(gameData);
      updateOverallBarChart(avgScores);
      updateConsistencyChart(consistencyData);
    }

    // Update overall radar chart (all three games)
    function updateOverallRadarChart(gameData, avgScores) {
      const canvas = document.getElementById('overall-radar');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      
      const datasets = [
        {
          label: 'Game 1',
          data: gameData[0].scores,
          fill: false,
          borderColor: '#8b5cf6',
          backgroundColor: 'rgba(139, 92, 246, 0.1)',
          pointBackgroundColor: '#8b5cf6'
        },
        {
          label: 'Game 2',
          data: gameData[1].scores,
          fill: false,
          borderColor: '#10b981',
          backgroundColor: 'rgba(16, 185, 129, 0.1)',
          pointBackgroundColor: '#10b981'
        },
        {
          label: 'Game 3',
          data: gameData[2].scores,
          fill: false,
          borderColor: '#f59e0b',
          backgroundColor: 'rgba(245, 158, 11, 0.1)',
          pointBackgroundColor: '#f59e0b'
        },
        {
          label: 'Average',
          data: avgScores,
          fill: true,
          borderColor: '#1e3a8a',
          backgroundColor: 'rgba(30, 58, 138, 0.2)',
          pointBackgroundColor: '#1e3a8a',
          borderWidth: 3
        }
      ];

      const data = {
        labels: ['Technical', 'Physical', 'Psychological', 'Social'],
        datasets: datasets
      };

      const config = {
        type: 'radar',
        data: data,
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: {
            r: {
              beginAtZero: true,
              max: 10,
              ticks: {
                stepSize: 2
              }
            }
          },
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      };

      if (charts.overall.radar) {
        charts.overall.radar.destroy();
      }
      
      charts.overall.radar = new Chart(ctx, config);
    }

    // Update overall line chart (progression)
    function updateOverallLineChart(gameData) {
      const canvas = document.getElementById('overall-line');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      
      const data = {
        labels: ['Game 1', 'Game 2', 'Game 3'],
        datasets: [
          {
            label: 'Technical',
            data: gameData.map(game => game.scores[0]),
            borderColor: '#8b5cf6',
            backgroundColor: 'rgba(139, 92, 246, 0.1)',
            tension: 0.4
          },
          {
            label: 'Physical',
            data: gameData.map(game => game.scores[1]),
            borderColor: '#10b981',
            backgroundColor: 'rgba(16, 185, 129, 0.1)',
            tension: 0.4
          },
          {
            label: 'Psychological',
            data: gameData.map(game => game.scores[2]),
            borderColor: '#f59e0b',
            backgroundColor: 'rgba(245, 158, 11, 0.1)',
            tension: 0.4
          },
          {
            label: 'Social',
            data: gameData.map(game => game.scores[3]),
            borderColor: '#ef4444',
            backgroundColor: 'rgba(239, 68, 68, 0.1)',
            tension: 0.4
          },
          {
            label: 'Overall',
            data: gameData.map(game => game.overall),
            borderColor: '#1e3a8a',
            backgroundColor: 'rgba(30, 58, 138, 0.1)',
            borderWidth: 3,
            tension: 0.4
          }
        ]
      };

      const config = {
        type: 'line',
        data: data,
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: {
            y: {
              beginAtZero: true,
              max: 10
            }
          },
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      };

      if (charts.overall.line) {
        charts.overall.line.destroy();
      }
      
      charts.overall.line = new Chart(ctx, config);
    }

    // Update overall bar chart (averages)
    function updateOverallBarChart(avgScores) {
      const canvas = document.getElementById('overall-bar');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      
      const colors = ['#8b5cf6', '#10b981', '#f59e0b', '#ef4444'];
      
      const data = {
        labels: ['Technical', 'Physical', 'Psychological', 'Social'],
        datasets: [{
          label: 'Average Score',
          data: avgScores,
          backgroundColor: colors,
          borderColor: colors,
          borderWidth: 2,
          borderRadius: 8
        }]
      };

      const config = {
        type: 'bar',
        data: data,
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: {
            y: {
              beginAtZero: true,
              max: 10
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      };

      if (charts.overall.bar) {
        charts.overall.bar.destroy();
      }
      
      charts.overall.bar = new Chart(ctx, config);
    }

    // Update consistency chart
    function updateConsistencyChart(consistencyData) {
      const canvas = document.getElementById('overall-consistency-chart');
      if (!canvas) return;
      
      const ctx = canvas.getContext('2d');
      
      const colors = ['#8b5cf6', '#10b981', '#f59e0b', '#ef4444'];
      
      const data = {
        labels: ['Technical', 'Physical', 'Psychological', 'Social'],
        datasets: [{
          label: 'Consistency (Lower is Better)',
          data: consistencyData,
          backgroundColor: colors.map(color => color + '40'),
          borderColor: colors,
          borderWidth: 2,
          borderRadius: 8
        }]
      };

      const config = {
        type: 'bar',
        data: data,
        options: {
          responsive: true,
          maintainAspectRatio: true,
          scales: {
            y: {
              beginAtZero: true,
              max: 3,
              ticks: {
                callback: function(value) {
                  if (value <= 0.5) return value.toFixed(1) + ' (Excellent)';
                  if (value <= 1.0) return value.toFixed(1) + ' (Good)';
                  if (value <= 1.5) return value.toFixed(1) + ' (Average)';
                  return value.toFixed(1) + ' (Poor)';
                }
              }
            }
          },
          plugins: {
            legend: {
              display: false
            }
          }
        }
      };

      if (charts.overall.consistency) {
        charts.overall.consistency.destroy();
      }
      
      charts.overall.consistency = new Chart(ctx, config);
    }

    // Excel Export Functions
    function exportGameExcel(game) {
      try {
        const gameData = collectGameData(game);
        const wb = XLSX.utils.book_new();
        
        // Player Info Sheet
        const playerInfoData = [
          ['JakeInSport - Game Analysis Report'],
          [''],
          ['Player Information'],
          ['Player Name', gameData.playerName || 'N/A'],
          ['Position', gameData.position || 'N/A'],
          ['Age', gameData.age || 'N/A'],
          ['Match Date', gameData.matchDate || 'N/A'],
          ['Opposition', gameData.opposition || 'N/A'],
          ['Competition', gameData.competition || 'N/A'],
          ['Match Result', gameData.result || 'N/A'],
          ['Minutes Played', gameData.minutes || 'N/A'],
          [''],
          ['Overall Rating', gameData.overall]
        ];
        
        const playerWS = XLSX.utils.aoa_to_sheet(playerInfoData);
        XLSX.utils.book_append_sheet(wb, playerWS, 'Player Info');

        // Category Scores Sheet
        const categoryData = [
          ['Category Scores'],
          [''],
          ['Category', 'Score (out of 10)'],
          ['Technical', gameData.categoryScores.technical],
          ['Physical', gameData.categoryScores.physical],
          ['Psychological', gameData.categoryScores.psychological],
          ['Social', gameData.categoryScores.social],
          [''],
          ['Overall Average', gameData.overall]
        ];
        
        const categoryWS = XLSX.utils.aoa_to_sheet(categoryData);
        XLSX.utils.book_append_sheet(wb, categoryWS, 'Category Scores');

        // Detailed Traits Sheet
        const traitsData = [
          ['Detailed Trait Analysis'],
          [''],
          ['Category', 'Trait', 'Score (1-10)']
        ];

        const traitLabels = {
          technical: ['Ball Control', 'Passing', 'Shooting', 'Dribbling', 'Defending'],
          physical: ['Pace', 'Strength', 'Stamina', 'Agility', 'Aerial Ability'],
          psychological: ['Concentration', 'Confidence', 'Composure', 'Mental Strength', 'Decision Making'],
          social: ['Communication', 'Leadership', 'Teamwork', 'Attitude', 'Respect']
        };

        const traitKeys = {
          technical: ['control', 'passing', 'shooting', 'dribbling', 'defending'],
          physical: ['pace', 'strength', 'stamina', 'agility', 'aerial'],
          psychological: ['concentration', 'confidence', 'composure', 'mental', 'decisions'],
          social: ['communication', 'leadership', 'teamwork', 'attitude', 'respect']
        };

        Object.keys(gameData.scores).forEach(category => {
          traitKeys[category].forEach((traitKey, index) => {
            traitsData.push([
              category.charAt(0).toUpperCase() + category.slice(1),
              traitLabels[category][index],
              gameData.scores[category][traitKey] || 'N/A'
            ]);
          });
          traitsData.push(['', '', '']); // Empty row between categories
        });

        const traitsWS = XLSX.utils.aoa_to_sheet(traitsData);
        XLSX.utils.book_append_sheet(wb, traitsWS, 'Detailed Traits');

        // Save file
        const playerName = gameData.playerName || 'Unknown_Player';
        XLSX.writeFile(wb, `JakeInSport_Game${game}_${playerName.replace(/\s+/g, '_')}.xlsx`);
        
        alert(`Game ${game} data exported to Excel successfully!`);
      } catch (error) {
        console.error('Excel export error:', error);
        alert('Error exporting to Excel. Please try again.');
      }
    }

    function exportCompleteExcel() {
      try {
        const wb = XLSX.utils.book_new();
        const playerData = collectPlayerData();
        
        // Summary Sheet
        const summaryData = [
          ['JakeInSport - Complete Scout Report'],
          [''],
          ['Player Summary'],
          ['Player Name', playerData.games[0]?.playerName || 'N/A'],
          ['Position', playerData.games[0]?.position || 'N/A'],
          ['Age', playerData.games[0]?.age || 'N/A'],
          [''],
          ['Overall Performance'],
          ['Final Rating', playerData.overallAverage.toFixed(1)],
          [''],
          ['Category Averages'],
          ['Technical', playerData.averages.technical.toFixed(1)],
          ['Physical', playerData.averages.physical.toFixed(1)],
          ['Psychological', playerData.averages.psychological.toFixed(1)],
          ['Social', playerData.averages.social.toFixed(1)],
          [''],
          ['Consistency Analysis (Standard Deviation)'],
          ['Technical Consistency', playerData.consistency.technical.toFixed(2)],
          ['Physical Consistency', playerData.consistency.physical.toFixed(2)],
          ['Psychological Consistency', playerData.consistency.psychological.toFixed(2)],
          ['Social Consistency', playerData.consistency.social.toFixed(2)]
        ];

        const summaryWS = XLSX.utils.aoa_to_sheet(summaryData);
        XLSX.utils.book_append_sheet(wb, summaryWS, 'Summary');

        // Game Comparison Sheet
        const comparisonData = [
          ['Three Game Comparison'],
          [''],
          ['Game', 'Overall Score', 'Opposition', 'Result', 'Technical', 'Physical', 'Psychological', 'Social']
        ];

        playerData.games.forEach((game, index) => {
          comparisonData.push([
            `Game ${index + 1}`,
            game.overall.toFixed(1),
            game.opposition || 'N/A',
            game.result || 'N/A',
            game.scores.technical.toFixed(1),
            game.scores.physical.toFixed(1),
            game.scores.psychological.toFixed(1),
            game.scores.social.toFixed(1)
          ]);
        });

        comparisonData.push([
          'AVERAGE',
          playerData.overallAverage.toFixed(1),
          'N/A',
          'N/A',
          playerData.averages.technical.toFixed(1),
          playerData.averages.physical.toFixed(1),
          playerData.averages.psychological.toFixed(1),
          playerData.averages.social.toFixed(1)
        ]);

        const comparisonWS = XLSX.utils.aoa_to_sheet(comparisonData);
        XLSX.utils.book_append_sheet(wb, comparisonWS, 'Game Comparison');

        // Detailed Analysis for Each Game
        for (let game = 1; game <= 3; game++) {
          const gameData = collectGameData(game);
          const gameDetailsData = [
            [`Game ${game} - Detailed Analysis`],
            [''],
            ['Player Information'],
            ['Player Name', gameData.playerName || 'N/A'],
            ['Opposition', gameData.opposition || 'N/A'],
            ['Result', gameData.result || 'N/A'],
            ['Minutes Played', gameData.minutes || 'N/A'],
            [''],
            ['Category', 'Trait', 'Score (1-10)']
          ];

          const traitLabels = {
            technical: ['Ball Control', 'Passing', 'Shooting', 'Dribbling', 'Defending'],
            physical: ['Pace', 'Strength', 'Stamina', 'Agility', 'Aerial Ability'],
            psychological: ['Concentration', 'Confidence', 'Composure', 'Mental Strength', 'Decision Making'],
            social: ['Communication', 'Leadership', 'Teamwork', 'Attitude', 'Respect']
          };

          const traitKeys = {
            technical: ['control', 'passing', 'shooting', 'dribbling', 'defending'],
            physical: ['pace', 'strength', 'stamina', 'agility', 'aerial'],
            psychological: ['concentration', 'confidence', 'composure', 'mental', 'decisions'],
            social: ['communication', 'leadership', 'teamwork', 'attitude', 'respect']
          };

          Object.keys(gameData.scores).forEach(category => {
            traitKeys[category].forEach((traitKey, index) => {
              gameDetailsData.push([
                category.charAt(0).toUpperCase() + category.slice(1),
                traitLabels[category][index],
                gameData.scores[category][traitKey] || 'N/A'
              ]);
            });
            gameDetailsData.push(['', '', '']); // Empty row between categories
          });

          gameDetailsData.push(['Category Averages', '', '']);
          gameDetailsData.push(['Technical', '', gameData.categoryScores.technical]);
          gameDetailsData.push(['Physical', '', gameData.categoryScores.physical]);
          gameDetailsData.push(['Psychological', '', gameData.categoryScores.psychological]);
          gameDetailsData.push(['Social', '', gameData.categoryScores.social]);
          gameDetailsData.push(['']);
          gameDetailsData.push(['Overall Rating', '', gameData.overall]);

          const gameWS = XLSX.utils.aoa_to_sheet(gameDetailsData);
          XLSX.utils.book_append_sheet(wb, gameWS, `Game ${game} Details`);
        }

        // AI Analysis Sheet (if available)
        const aiContent = document.getElementById('ai-overview-content');
        if (aiContent && !aiContent.textContent.includes('Click "Generate AI Analysis"')) {
          const aiData = [
            ['AI Analysis & Recommendations'],
            [''],
            [aiContent.textContent]
          ];
          const aiWS = XLSX.utils.aoa_to_sheet(aiData);
          XLSX.utils.book_append_sheet(wb, aiWS, 'AI Analysis');
        }

        // Save file
        const playerName = playerData.games[0]?.playerName || 'Unknown_Player';
        XLSX.writeFile(wb, `JakeInSport_Complete_Report_${playerName.replace(/\s+/g, '_')}.xlsx`);
        
        alert('Complete scout report exported to Excel successfully!');
      } catch (error) {
        console.error('Complete Excel export error:', error);
        alert('Error exporting complete report to Excel. Please try again.');
      }
    }

    // PDF Export Functions
    async function exportGamePDF(game) {
      showPDFLoadingOverlay();
      
      try {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pageWidth = 210;
        const pageHeight = 297;
        let yPosition = 20;

        // Collect game data
        const gameData = collectGameData(game);
        const playerName = gameData.playerName || 'Unknown Player';
        const opposition = gameData.opposition || 'Unknown';
        const matchDate = gameData.matchDate || 'Unknown';
        const competition = gameData.competition || 'Unknown';
        const result = gameData.result || 'N/A';

        // Header
        pdf.setFontSize(24);
        pdf.setTextColor(30, 58, 138);
        pdf.text('JakeInSport - Game Analysis', pageWidth / 2, yPosition, { align: 'center' });
        yPosition += 10;

        pdf.setFontSize(16);
        pdf.text(`Game ${game} Report`, pageWidth / 2, yPosition, { align: 'center' });
        yPosition += 20;

        // Player Information
        pdf.setFontSize(14);
        pdf.setTextColor(0, 0, 0);
        pdf.text(`Player: ${playerName}`, 20, yPosition);
        yPosition += 8;
        pdf.text(`Position: ${gameData.position || 'N/A'}`, 20, yPosition);
        yPosition += 8;
        pdf.text(`Age: ${gameData.age || 'N/A'}`, 20, yPosition);
        yPosition += 8;
        pdf.text(`Opposition: ${opposition}`, 20, yPosition);
        yPosition += 8;
        pdf.text(`Competition: ${competition}`, 20, yPosition);
        yPosition += 8;
        pdf.text(`Match Date: ${matchDate}`, 20, yPosition);
        yPosition += 8;
        pdf.text(`Result: ${result}`, 20, yPosition);
        yPosition += 8;
        pdf.text(`Minutes Played: ${gameData.minutes || 'N/A'}`, 20, yPosition);
        yPosition += 20;

        // Overall Rating
        pdf.setFontSize(16);
        pdf.setTextColor(30, 58, 138);
        pdf.text('Overall Rating', 20, yPosition);
        yPosition += 10;
        pdf.setFontSize(48);
        pdf.text(`${gameData.overall}/10`, pageWidth / 2, yPosition, { align: 'center' });
        yPosition += 25;

        // Category Scores
        pdf.setFontSize(14);
        pdf.setTextColor(0, 0, 0);
        pdf.text('Category Scores:', 20, yPosition);
        yPosition += 10;

        const categories = ['technical', 'physical', 'psychological', 'social'];
        const categoryColors = [
          [139, 92, 246],  // technical
          [16, 185, 129],  // physical  
          [245, 158, 11],  // psychological
          [239, 68, 68]    // social
        ];

        categories.forEach((cat, index) => {
          pdf.setTextColor(...categoryColors[index]);
          pdf.text(`${cat.charAt(0).toUpperCase() + cat.slice(1)}: ${gameData.categoryScores[cat]}/10`, 20, yPosition);
          yPosition += 8;
        });
        yPosition += 10;

        // Capture and add charts
        if (yPosition > 200) {
          pdf.addPage();
          yPosition = 20;
        }

        pdf.setTextColor(0, 0, 0);
        pdf.text('Performance Charts', 20, yPosition);
        yPosition += 15;

        // Capture radar chart
        const radarCanvas = document.getElementById(`game${game}-radar`);
        if (radarCanvas) {
          const radarImage = radarCanvas.toDataURL('image/png');
          pdf.addImage(radarImage, 'PNG', 20, yPosition, 80, 60);
        }

        // Capture bar chart
        const barCanvas = document.getElementById(`game${game}-bar`);
        if (barCanvas) {
          const barImage = barCanvas.toDataURL('image/png');
          pdf.addImage(barImage, 'PNG', 110, yPosition, 80, 60);
        }
        
        yPosition += 70;

        // Detailed trait scores
        if (yPosition > 200) {
          pdf.addPage();
          yPosition = 20;
        }

        pdf.text('Detailed Trait Analysis', 20, yPosition);
        yPosition += 15;

        const traits = {
          technical: ['Ball Control', 'Passing', 'Shooting', 'Dribbling', 'Defending'],
          physical: ['Pace', 'Strength', 'Stamina', 'Agility', 'Aerial Ability'],
          psychological: ['Concentration', 'Confidence', 'Composure', 'Mental Strength', 'Decision Making'],
          social: ['Communication', 'Leadership', 'Teamwork', 'Attitude', 'Respect']
        };

        categories.forEach((cat, catIndex) => {
          pdf.setFontSize(12);
          pdf.setTextColor(...categoryColors[catIndex]);
          pdf.text(`${cat.charAt(0).toUpperCase() + cat.slice(1)} Skills:`, 20, yPosition);
          yPosition += 8;

          pdf.setFontSize(10);
          pdf.setTextColor(0, 0, 0);
          
          traits[cat].forEach(traitName => {
            const traitKey = Object.keys(gameData.scores[cat])[traits[cat].indexOf(traitName)];
            const score = gameData.scores[cat][traitKey] || 'N/A';
            pdf.text(`  â€¢ ${traitName}: ${score}/10`, 25, yPosition);
            yPosition += 5;
          });
          yPosition += 5;
        });

        // Save PDF
        pdf.save(`JakeInSport_Game${game}_${playerName.replace(/\s+/g, '_')}.pdf`);
        
      } catch (error) {
        console.error('PDF export error:', error);
        alert('Error generating PDF. Please try again.');
      } finally {
        hidePDFLoadingOverlay();
      }
    }

    async function exportOverallPDF() {
      showPDFLoadingOverlay();
      
      try {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pageWidth = 210;
        const pageHeight = 297;
        let yPosition = 20;

        // Get player data
        const playerData = collectPlayerData();
        const playerName = playerData.games[0].playerName || 'Unknown Player';

        // Header
        pdf.setFontSize(24);
        pdf.setTextColor(30, 58, 138);
        pdf.text('JakeInSport - Complete Scout Report', pageWidth / 2, yPosition, { align: 'center' });
        yPosition += 15;

        pdf.setFontSize(16);
        pdf.text(`Player: ${playerName}`, pageWidth / 2, yPosition, { align: 'center' });
        yPosition += 25;

        // Executive Summary
        pdf.setFontSize(14);
        pdf.setTextColor(0, 0, 0);
        pdf.text('Executive Summary', 20, yPosition);
        yPosition += 10;

        pdf.setFontSize(12);
        pdf.text(`Overall Average Rating: ${playerData.overallAverage.toFixed(1)}/10`, 20, yPosition);
        yPosition += 8;

        const categories = ['technical', 'physical', 'psychological', 'social'];
        categories.forEach(cat => {
          pdf.text(`${cat.charAt(0).toUpperCase() + cat.slice(1)}: ${playerData.averages[cat].toFixed(1)}/10 (Consistency: ${playerData.consistency[cat].toFixed(2)})`, 20, yPosition);
          yPosition += 6;
        });
        yPosition += 15;

        // Three Game Comparison
        pdf.setFontSize(14);
        pdf.text('Three Game Performance', 20, yPosition);
        yPosition += 10;

        playerData.games.forEach((game, index) => {
          pdf.setFontSize(12);
          pdf.text(`Game ${index + 1}: ${game.overall.toFixed(1)}/10 vs ${game.opposition} (${game.result})`, 20, yPosition);
          yPosition += 6;
        });
        yPosition += 15;

        // Consistency Analysis
        pdf.text('Consistency Analysis', 20, yPosition);
        yPosition += 10;

        pdf.setFontSize(11);
        categories.forEach(cat => {
          const consistency = playerData.consistency[cat];
          let rating = 'Poor';
          if (consistency <= 0.5) rating = 'Excellent';
          else if (consistency <= 1.0) rating = 'Good';
          else if (consistency <= 1.5) rating = 'Average';
          
          pdf.text(`${cat.charAt(0).toUpperCase() + cat.slice(1)}: ${rating} (${consistency.toFixed(2)})`, 20, yPosition);
          yPosition += 6;
        });
        yPosition += 15;

        // Add new page for charts
        pdf.addPage();
        yPosition = 20;

        pdf.setFontSize(16);
        pdf.text('Performance Charts', 20, yPosition);
        yPosition += 15;

        // Capture overall charts
        const overallRadarCanvas = document.getElementById('overall-radar');
        if (overallRadarCanvas) {
          const radarImage = overallRadarCanvas.toDataURL('image/png');
          pdf.addImage(radarImage, 'PNG', 20, yPosition, 80, 60);
        }

        const overallLineCanvas = document.getElementById('overall-line');
        if (overallLineCanvas) {
          const lineImage = overallLineCanvas.toDataURL('image/png');
          pdf.addImage(lineImage, 'PNG', 110, yPosition, 80, 60);
        }
        yPosition += 70;

        const overallBarCanvas = document.getElementById('overall-bar');
        if (overallBarCanvas) {
          const barImage = overallBarCanvas.toDataURL('image/png');
          pdf.addImage(barImage, 'PNG', 20, yPosition, 80, 60);
        }

        const consistencyCanvas = document.getElementById('overall-consistency-chart');
        if (consistencyCanvas) {
          const consistencyImage = consistencyCanvas.toDataURL('image/png');
          pdf.addImage(consistencyImage, 'PNG', 110, yPosition, 80, 60);
        }
        yPosition += 70;

        // AI Analysis if available
        const aiContent = document.getElementById('ai-overview-content');
        if (aiContent && !aiContent.textContent.includes('Click "Generate AI Analysis"')) {
          pdf.addPage();
          yPosition = 20;
          
          pdf.setFontSize(16);
          pdf.text('AI Analysis', 20, yPosition);
          yPosition += 15;
          
          pdf.setFontSize(10);
          const aiText = aiContent.textContent;
          const lines = pdf.splitTextToSize(aiText, pageWidth - 40);
          pdf.text(lines, 20, yPosition);
        }

        // Save PDF
        pdf.save(`JakeInSport_Complete_Report_${playerName.replace(/\s+/g, '_')}.pdf`);
        
      } catch (error) {
        console.error('PDF export error:', error);
        alert('Error generating PDF. Please try again.');
      } finally {
        hidePDFLoadingOverlay();
      }
    }

    // PDF Loading Overlay Functions
    function showPDFLoadingOverlay() {
      document.getElementById('pdf-overlay').style.display = 'flex';
    }

    function hidePDFLoadingOverlay() {
      document.getElementById('pdf-overlay').style.display = 'none';
    }

    // Generate AI Overview
    function generateAIOverview() {
      const btn = document.getElementById("generate-ai-btn");
      const aiContent = document.getElementById("ai-overview-content");

      btn.disabled = true;
      btn.innerHTML = '<span class="spinner"></span> Generating...';

      setTimeout(() => {
        const categories = ['technical', 'physical', 'psychological', 'social'];
        const consistencies = {};
        const averages = {};
        let mostConsistent = null, leastConsistent = null;
        let minSD = Infinity, maxSD = -Infinity;
        let minScore = Infinity, maxScore = -Infinity;

        categories.forEach(cat => {
          const sd = parseFloat(document.getElementById(`${cat}-consistency-value`).textContent);
          const avgVal = [1, 2, 3].map(i =>
            parseFloat(document.getElementById(`game${i}-${cat}-score`).textContent)
          ).reduce((a, b) => a + b, 0) / 3;

          consistencies[cat] = sd;
          averages[cat] = avgVal;

          if (sd < minSD) {
            minSD = sd;
            mostConsistent = cat;
          }
          if (sd > maxSD) {
            maxSD = sd;
            leastConsistent = cat;
          }
          if (avgVal < minScore) {
            minScore = avgVal;
          }
          if (avgVal > maxScore) {
            maxScore = avgVal;
          }
        });

        const categoryLabels = {
          technical: "Technical",
          physical: "Physical",
          psychological: "Psychological",
          social: "Social"
        };

        const goodAt = Object.keys(averages).filter(c => averages[c] === maxScore).map(c => categoryLabels[c]).join(", ");
        const needsSupport = Object.keys(averages).filter(c => averages[c] === minScore).map(c => categoryLabels[c]).join(", ");

        const ages = [1, 2, 3].map(i => parseInt(document.getElementById(`game${i}-age`).value || "0"));
        const avgAge = Math.round(ages.reduce((a, b) => a + b, 0) / ages.length);
        const minutesPlayed = [1, 2, 3].map(i => parseInt(document.getElementById(`game${i}-minutes`).value || "0"));
        const avgMinutes = Math.round(minutesPlayed.reduce((a, b) => a + b, 0) / 3);

        const recommendation = avgMinutes >= 85
          ? "Consistently playing around 90 minutes each game shows strong physical condition and tactical trust from the coach."
          : "Consider building fitness or tactical influence to earn more minutes on the pitch.";

        aiContent.innerHTML = `
          <p><strong>Summary:</strong> The player's strongest performance area is <strong>${goodAt}</strong>, while <strong>${needsSupport}</strong> requires more development.</p>
          <p><strong>Consistency:</strong> The <strong>most consistent</strong> category was <strong>${categoryLabels[mostConsistent]}</strong> (lowest standard deviation), and the <strong>least consistent</strong> was <strong>${categoryLabels[leastConsistent]}</strong> (highest deviation, suggesting instability).</p>
          <p><strong>Age:</strong> The player is approximately <strong>${avgAge} years old</strong>.</p>
          <p><strong>Minutes Played:</strong> Average of <strong>${avgMinutes} minutes</strong> per game. ${recommendation}</p>
          <p><strong>Recommendations:</strong></p>
          <ul>
            <li>Focus training efforts on ${needsSupport.toLowerCase()} traits to create a more well-rounded profile.</li>
            <li>Enhance consistency in ${categoryLabels[leastConsistent]} through targeted routines and match experience.</li>
            <li>Maintain strengths in ${goodAt.toLowerCase()}, but avoid complacency.</li>
          </ul>
          <p><strong>Overall:</strong> The player is progressing well with clear areas of strength and development. Support in weak traits and consistency will elevate overall performance.</p>
        `;

        btn.innerHTML = 'Regenerate AI Analysis';
        btn.disabled = false;
      }, 1500);
    }

    // Load sample data for a specific game
    function loadSampleData(game) {
      const sampleData = {
        1: {
          playerName: 'Marcus Rodriguez',
          position: 'CM',
          age: '22',
          matchDate: '2024-06-15',
          opposition: 'Manchester City',
          competition: 'Premier League',
          result: '2-1 Win',
          minutes: '87',
          scores: [8, 7, 6, 9, 7, 8, 9, 8, 7, 8, 7, 8, 7, 6, 8, 9, 8, 7, 8, 9]
        },
        2: {
          playerName: 'Marcus Rodriguez',
          position: 'CM',
          age: '22',
          matchDate: '2024-06-22',
          opposition: 'Arsenal FC',
          competition: 'Premier League',
          result: '1-1 Draw',
          minutes: '90',
          scores: [7, 8, 5, 8, 6, 7, 8, 7, 6, 7, 8, 7, 8, 7, 9, 8, 7, 8, 7, 8]
        },
        3: {
          playerName: 'Marcus Rodriguez',
          position: 'CM',
          age: '22',
          matchDate: '2024-06-29',
          opposition: 'Chelsea FC',
          competition: 'Premier League',
          result: '3-0 Win',
          minutes: '90',
          scores: [9, 8, 7, 9, 8, 9, 8, 9, 8, 9, 8, 9, 8, 7, 9, 9, 9, 8, 9, 9]
        }
      };

      const data = sampleData[game];
      
      // Set player info
      document.getElementById(`game${game}-playerName`).value = data.playerName;
      document.getElementById(`game${game}-position`).value = data.position;
      document.getElementById(`game${game}-age`).value = data.age;
      document.getElementById(`game${game}-matchDate`).value = data.matchDate;
      document.getElementById(`game${game}-opposition`).value = data.opposition;
      document.getElementById(`game${game}-competition`).value = data.competition;
      document.getElementById(`game${game}-result`).value = data.result;
      document.getElementById(`game${game}-minutes`).value = data.minutes;
      
      // Set scores
      const sliders = document.querySelectorAll(`input[data-game="${game}"]`);
      sliders.forEach((slider, index) => {
        slider.value = data.scores[index] || 5;
        const scoreSpan = slider.parentElement.querySelector('.score');
        scoreSpan.textContent = slider.value;
      });
      
      updateGameScores(game);
      updateGameCharts(game);
      
      // Reset AI overview when sample data is loaded
      aiOverviewGenerated = false;
      resetAIOverview();
    }

    // Load all sample data
    function loadAllSampleData() {
      for (let game = 1; game <= 3; game++) {
        loadSampleData(game);
      }
      updateOverallAnalysis();
      // Reset AI overview when all sample data is loaded
      aiOverviewGenerated = false;
      resetAIOverview();
    }

    function saveGameJSON(game) {
      const gameData = collectGameData(game);
      const dataStr = JSON.stringify(gameData, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      
      const link = document.createElement('a');
      link.href = URL.createObjectURL(dataBlob);
      link.download = `JakeInSport_Game${game}_${gameData.playerName.replace(/\s+/g, '_')}.json`;
      link.click();
    }

    function saveCompleteJSON() {
      const completeData = {
        games: [],
        summary: collectPlayerData()
      };
      
      for (let game = 1; game <= 3; game++) {
        completeData.games.push(collectGameData(game));
      }
      
      const dataStr = JSON.stringify(completeData, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      
      const playerName = document.getElementById('game1-playerName').value || 'Unknown_Player';
      const link = document.createElement('a');
      link.href = URL.createObjectURL(dataBlob);
      link.download = `JakeInSport_Complete_Report_${playerName.replace(/\s+/g, '_')}.json`;
      link.click();
    }

    function collectGameData(game) {
      const categories = ['technical', 'physical', 'psychological', 'social'];
      const traits = {
        technical: ['control', 'passing', 'shooting', 'dribbling', 'defending'],
        physical: ['pace', 'strength', 'stamina', 'agility', 'aerial'],
        psychological: ['concentration', 'confidence', 'composure', 'mental', 'decisions'],
        social: ['communication', 'leadership', 'teamwork', 'attitude', 'respect']
      };
      
      const gameData = {
        playerName: document.getElementById(`game${game}-playerName`).value,
        position: document.getElementById(`game${game}-position`).value,
        age: document.getElementById(`game${game}-age`).value,
        matchDate: document.getElementById(`game${game}-matchDate`).value,
        opposition: document.getElementById(`game${game}-opposition`).value,
        competition: document.getElementById(`game${game}-competition`).value,
        result: document.getElementById(`game${game}-result`).value,
        minutes: document.getElementById(`game${game}-minutes`).value,
        scores: {},
        categoryScores: {},
        overall: parseFloat(document.getElementById(`game${game}-overall`).textContent)
      };
      
      // Collect individual trait scores
      categories.forEach(cat => {
        gameData.scores[cat] = {};
        traits[cat].forEach(trait => {
          const slider = document.querySelector(`input[data-game="${game}"][data-cat="${cat}"][data-trait="${trait}"]`);
          if (slider) {
            gameData.scores[cat][trait] = parseInt(slider.value);
          }
        });
        const categoryElement = document.getElementById(`game${game}-${cat}-score`);
        gameData.categoryScores[cat] = categoryElement ? parseFloat(categoryElement.textContent) : 5.0;
      });
      
      return gameData;
    }

    // Collect player data for AI analysis
    function collectPlayerData() {
      const categories = ['technical', 'physical', 'psychological', 'social'];
      const gameData = [];
      
      for (let game = 1; game <= 3; game++) {
        const gameInfo = {
          game: game,
          playerName: document.getElementById(`game${game}-playerName`)?.value || 'Unknown Player',
          position: document.getElementById(`game${game}-position`)?.value || 'Unknown',
          opposition: document.getElementById(`game${game}-opposition`)?.value || 'Unknown',
          result: document.getElementById(`game${game}-result`)?.value || 'N/A',
          scores: {},
          overall: parseFloat(document.getElementById(`game${game}-overall`)?.textContent || '5.0')
        };
        
        // Collect category scores
        categories.forEach(cat => {
          const element = document.getElementById(`game${game}-${cat}-score`);
          gameInfo.scores[cat] = element ? parseFloat(element.textContent) : 5.0;
        });
        
        gameData.push(gameInfo);
      }
      
      // Calculate averages and consistency
      const avgScores = {};
      const consistency = {};
      
      categories.forEach(cat => {
        const scores = gameData.map(game => game.scores[cat]);
        const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
        const variance = scores.reduce((acc, score) => acc + Math.pow(score - avg, 2), 0) / scores.length;
        const stdDev = Math.sqrt(variance);
        
        avgScores[cat] = avg;
        consistency[cat] = stdDev;
      });
      
      const avgOverall = gameData.reduce((acc, game) => acc + game.overall, 0) / gameData.length;
      
      return {
        games: gameData,
        averages: avgScores,
        consistency: consistency,
        overallAverage: avgOverall
      };
    }
  </script>
</body>
</html>